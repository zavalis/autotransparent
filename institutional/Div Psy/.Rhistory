source("~/Documents/GitHub/transp_inf_dis/tables.R")
# read df
df=read.delim('./transp.csv',sep=',')
# read df
df=read.delim('./transp.csv',sep=',')
setwd("~/Documents/GitHub/autotransparent/institutional/Div Psy")
# read df
df=read.delim('./transp.csv',sep=',')
colnames(df)
# TABLE 1
# to get the sum of journals' publications
table(df$publication_year)
## overall transparency
write.csv(df  %>%
summarise_at(c("is_open_code", "is_open_data","is_register_pred", "is_coi_pred","is_fund_pred"), ~paste0(sum(.x), '(', round(sum(.x) * 100 / n()), ')')),'./table_transp_overall.csv')
# TABLE CREATION IN CSV
library(dplyr)
## overall transparency
write.csv(df  %>%
summarise_at(c("is_open_code", "is_open_data","is_register_pred", "is_coi_pred","is_fund_pred"), ~paste0(sum(.x), '(', round(sum(.x) * 100 / n()), ')')),'./table_transp_overall.csv')
str(df)
# read df
df=read.delim('./transp.csv',sep=',')
code_df=read.delim('./code.csv', sep=',')
rest_df=read.delim('./rest.csv', sep=',')
combined=merge(x = code_df, y = rest_df, by = "pmid", all = TRUE)
search=read.delim('./bib_pmc.csv', sep=',')
colnames(search)[1]='pmid'
colnames(search)[9]='pmcid_uid'
search_combined=merge(x = search, y = combined, by = "pmid", all = TRUE)
View(search)
search=read.delim('./bib_pmc.csv', sep=',')
search_combined=merge(x = search, y = combined, by = "pmid", all = TRUE)
# read df
df=read.delim('./transp.csv',sep=',')
colnames(select_combined)
colnames(search_combined)
select_combined=search_combined %>%
select(c(1,2,13,25,26,27,28,2943,42,68,67,114,113))
select_combined=search_combined %>%
select(c(1,2,13,25,26,27,28,29,43,42,68,67,114,113))
# read df
df=select_combined
# TABLE 1
# to get the sum of journals' publications
table(df$publication_year)
## overall transparency
write.csv(df  %>%
summarise_at(c("is_open_code", "is_open_data","is_register_pred", "is_coi_pred","is_fund_pred"), ~paste0(sum(.x), '(', round(sum(.x) * 100 / n()), ')')),'./table_transp_overall.csv')
df[df$is_open_code == NA | df$is_open_data == NA,]=FALSE
df[df$is_open_code == 'NA' | df$is_open_data == 'NA',]=FALSE
summary(df)
View(search_combined)
df$is_open_code
df$is_open_code==NA
select_combined=search_combined %>%
select(c(1,2,13,25,26,27,28,29,43,42,68,67,114,113))
# read df
df=select_combined
# TABLE 1
# to get the sum of journals' publications
table(df$publication_year)
df$is_open_code==NA
df[df$is_open_code == NA,]
# TABLE CREATION IN CSV
library(dplyr)
code_df=read.delim('./code.csv', sep=',')
rest_df=read.delim('./rest.csv', sep=',')
combined=merge(x = code_df, y = rest_df, by = "pmid", all = TRUE)
search=read.delim('./bib_pmc.csv', sep=',')
search_combined=merge(x = search, y = combined, by = "pmid", all = TRUE)
select_combined=search_combined %>%
select(c(1,2,13,25,26,27,28,29,43,42,68,67,114,113))
# read df
df=select_combined
# TABLE 1
# to get the sum of journals' publications
table(df$publication_year)
# TABLE 1
# to get the sum of journals' publications
table(df$is_open_code)
df[df$is_open_code==NA,]
df[df$is_open_code=='NA',]
# TABLE 1
# to get the sum of journals' publications
table(df$is_open_code)
View(select_combined)
df%>%filter(is_open_code==NA)
df%>%filter(is_open_code=='NA')
df$is_open_code[df$is_open_code==NA]
df$is_open_code[df$is_open_code==NA,]
df
df$is_open_code
df$is_open_code[is.na(df$is_open_code)]
df$is_open_data[is.na(df$is_open_data)]=FALSE
## overall transparency
write.csv(df  %>%
summarise_at(c("is_open_code", "is_open_data","is_register_pred", "is_coi_pred","is_fund_pred"), ~paste0(sum(.x), '(', round(sum(.x) * 100 / n()), ')')),'./table_transp_overall.csv')
summary(df)
# antar att NAs är false
df$is_open_code[is.na(df$is_open_code)]=FALSE
df$is_open_data[is.na(df$is_open_data)]=FALSE
## overall transparency
write.csv(df  %>%
summarise_at(c("is_open_code", "is_open_data","is_register_pred", "is_coi_pred","is_fund_pred"), ~paste0(sum(.x), '(', round(sum(.x) * 100 / n()), ')')),'./table_transp_overall.csv')
## overall transparency
write.csv(df  %>%
summarise_at(c("is_open_code", "is_open_data","is_register_pred", "is_coi_pred","is_fund_pred"), ~paste0(sum(.x), '/ 415 (', round(sum(.x) * 100 / n()), ')')),'./table_transp_overall.csv')
### by year
write.csv(df %>% group_by(publication_year) %>%
summarise_at(c("is_open_code", "is_open_data","is_register_pred", "is_coi_pred","is_fund_pred"), ~paste0(sum(.x), '(', round(sum(.x) * 100 / n()), ')')),'./output/tables/table_transp_journals.csv') # change the nas.
### by year
write.csv(df %>% group_by(publication_year) %>%
summarise_at(c("is_open_code", "is_open_data","is_register_pred", "is_coi_pred","is_fund_pred"), ~paste0(sum(.x), '(', round(sum(.x) * 100 / n()), ')')),'./table_transp_year.csv') # change the nas.
### by last author affiliation
write.csv(df %>% group_by(last_au) %>%
summarise_at(c("is_open_code", "is_open_data","is_register_pred", "is_coi_pred","is_fund_pred"), ~paste0(sum(.x), '(', round(sum(.x) * 100 / n()), ')')),'./transp_last_au.csv') # change the nas.
View(select_combined)
colnames(search_combined)
select_combined=search_combined %>%
select(c(1,2,13,14,25,26,27,28,29,43,42,68,67,114,113))
# read df
df=select_combined
# TABLE 1
# to get the sum of journals' publications
table(df$is_open_code)
# antar att NAs är false
df$is_open_code[is.na(df$is_open_code)]=FALSE
df$is_open_data[is.na(df$is_open_data)]=FALSE
## overall transparency
write.csv(df  %>%
summarise_at(c("is_open_code", "is_open_data","is_register_pred", "is_coi_pred","is_fund_pred"), ~paste0(sum(.x), '/ 415 (', round(sum(.x) * 100 / n()), ')')),'./table_transp_overall.csv')
### by year
write.csv(df %>% group_by(publication_year) %>%
summarise_at(c("is_open_code", "is_open_data","is_register_pred", "is_coi_pred","is_fund_pred"), ~paste0(sum(.x), '(', round(sum(.x) * 100 / n()), ')')),'./table_transp_year.csv') # change the nas.
### by last author affiliation
write.csv(df %>% group_by(last_author) %>%
summarise_at(c("is_open_code", "is_open_data","is_register_pred", "is_coi_pred","is_fund_pred"), ~paste0(sum(.x), '(', round(sum(.x) * 100 / n()), ')')),'./transp_last_au.csv') # change the nas.
write.csv(table(df$publication_year), 'year.csv')
write.csv(table(df$last_author), 'last_au.csv')
